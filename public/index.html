
<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8">
  <title>‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ö‡∏¥‡∏Å‡∏ô‡πâ‡∏≥‡∏°‡∏±‡∏ô‡∏Ñ‡πà‡∏≤‡πÄ‡∏ó‡∏µ‡πà‡∏¢‡∏ß</title>
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
</head>
<body>
  <h1>‡∏ü‡∏≠‡∏£‡πå‡∏°‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ö‡∏¥‡∏Å‡∏ô‡πâ‡∏≥‡∏°‡∏±‡∏ô</h1>
  <form id="oilForm">
    <label>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà:</label><br>
    <input type="date" name="date" required><br><br>

    <label>‡∏ä‡∏∑‡πà‡∏≠ üôã:</label><br>
    <input type="text" name="name" required><br><br>

    <label>‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡∏£‡∏ñ üöõ:</label><br>
    <input type="text" name="car_no" required><br><br>

    <label>‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£:</label><br>
    <input type="tel" name="phone" required><br><br>

    <label>‡πÄ‡∏•‡∏Ç‡∏ö‡∏≤‡∏£‡πå:</label><br>
    <input type="text" name="barcode" required><br><br>

    <label>‡πÄ‡∏™‡πâ‡∏ô‡∏ó‡∏≤‡∏á:</label><br>
    <input type="text" name="route" required><br><br>

    <label>‡∏£‡∏≠‡∏ö‡πÄ‡∏ß‡∏•‡∏≤‡∏™‡πÅ‡∏ï‡∏ô‡∏ö‡∏≤‡∏¢:</label><br>
    <input type="text" name="standby_round" required><br><br>

    <label>‡πÄ‡∏ß‡∏•‡∏≤‡∏™‡πÅ‡∏ï‡∏ô‡∏ö‡∏≤‡∏¢:</label><br>
    <input type="time" name="standby_time" required><br><br>

    <label>‡∏≠‡∏≠‡∏Å‡πÄ‡∏î‡∏¥‡∏ô‡∏ó‡∏≤‡∏á:</label><br>
    <input type="time" name="departure_time" required><br><br>

    <label>‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏:</label><br>
    <textarea name="note"></textarea><br><br>

    <label>‡∏Ñ‡πà‡∏≤‡πÄ‡∏ó‡∏µ‡πà‡∏¢‡∏ß (‡∏ö‡∏≤‡∏ó):</label><br>
    <input type="number" name="trip_fee" id="trip_fee" required><br><br>

    <label>‡πÄ‡∏ö‡∏¥‡∏Å‡∏ô‡πâ‡∏≥‡∏°‡∏±‡∏ô (‡∏ö‡∏≤‡∏ó):</label><br>
    <input type="text" id="oil_claim" readonly><br><br>

    <label>‡∏ö‡∏±‡∏ç‡∏ä‡∏µ‡∏ò‡∏ô‡∏≤‡∏Ñ‡∏≤‡∏£:</label><br>
    <input type="text" name="bank" required><br><br>

    <label>‡∏ä‡∏∑‡πà‡∏≠‡∏ö‡∏±‡∏ç‡∏ä‡∏µ:</label><br>
    <input type="text" name="bank_name" required><br><br>

    <label>‡πÄ‡∏•‡∏Ç‡∏ö‡∏±‡∏ç‡∏ä‡∏µ:</label><br>
    <input type="text" name="bank_no" required><br><br>

    <button type="submit">‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</button>
  </form>
<script>
  const form = document.getElementById('oilForm');
  const tripFeeInput = document.getElementById('trip_fee');
  const oilClaimInput = document.getElementById('oil_claim');

  tripFeeInput.addEventListener('input', () => {
    const fee = parseFloat(tripFeeInput.value) || 0;
    oilClaimInput.value = (fee * 0.5).toFixed(2);
  });

  form.addEventListener('submit', async (e) => {
    e.preventDefault();
    const data = new FormData(form);
    const obj = {};
    data.forEach((value, key) => { obj[key] = value });
    obj.oil_claim = oilClaimInput.value;

    const dateParts = obj.date.split("-");
    obj.date = `${dateParts[2]}/${dateParts[1]}/${dateParts[0]}`;
    obj.oil_claim = oilClaimInput.value;
    const res = await fetch('/api/submit', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify(obj)
    });
    const text = await res.text();
    Swal.fire('‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!', text, 'success');
    form.reset();
    oilClaimInput.value = "";
  });
</script>
</body>
</html>
